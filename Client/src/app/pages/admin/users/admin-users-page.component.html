<p-toast />
<h2 class="text-xl font-semibold mb-4">Users & Roles</h2>
<p class="text-muted-foreground mb-6">View all users and assign or change their roles.</p>

<p-table
  [value]="users()"
  [lazy]="true"
  [paginator]="true"
  [rows]="10"
  [totalRecords]="totalRecords()"
  [loading]="loading()"
  (onPage)="pageChange($event)"
  [rowsPerPageOptions]="[10, 25, 50]"
  [showCurrentPageReport]="true"
  currentPageReportTemplate="Showing users {first} to {last} of total {totalRecords} users"
>
  <ng-template pTemplate="header">
    <tr>
      <th>Name</th>
      <th>Username</th>
      <th>Email</th>
      <th>Role</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-user>
    <tr>
      <td>{{ user.firstName }} {{ user.lastName }}</td>
      <td>{{ user.userName }}</td>
      <td>{{ user.email }}</td>
      <td>
        <p-select
          [options]="roles"
          [ngModel]="user.role"
          (ngModelChange)="onRoleChange(user, $event)"
          [disabled]="isSaving(user.userId)"
          [loading]="isSaving(user.userId)"
          optionLabel="label"
          optionValue="value"
          appendTo="body"
        />
      </td>
    </tr>
  </ng-template>
  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="4" class="text-center py-8 text-muted-foreground">No users found.</td>
    </tr>
  </ng-template>
</p-table>
