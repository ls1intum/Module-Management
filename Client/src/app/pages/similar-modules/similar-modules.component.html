<h1 class="text-2xl mb-8">Potential Module Overlaps</h1>

@if (isLoading) {
  <div class="fixed inset-0 flex justify-center items-center">
    <p-progress-spinner ariaLabel="loading" />
  </div>
} @else if (similarModules.length === 0) {
  <p-message severity="success">
    <div class="flex flex-row">
      <i class="pi pi-info-circle mt-1" style="font-size: 1.2rem"></i>
      <div class="ml-3">
        <p class="font-bold">No Similar Modules Found</p>
        <p>We couldn't find any modules that are similar to your proposal.</p>
      </div>
    </div>
  </p-message>
} @else {
  <div class="space-y-6">
    @for (module of similarModules; track module.moduleId) {
      <p-panel>
        <h3 class="text-lg font-medium">{{ module.titleEng || 'Module ' + module.moduleId }}</h3>
        <p class="text-sm text-muted-foreground mb-4">Module ID: {{ module.moduleId }}</p>

        <h4 class="font-medium mb-2">Module Content:</h4>
        <textarea pTextarea [value]="module.contentEng || ''" [disabled]="true" [readonly]="true" fluid autoResize="true"></textarea>

        @if (module.similarity !== undefined) {
          <ng-template #footer>
            <span class="text-sm text-muted-foreground mr-2">Similarity Score:</span>
            <p-tag [value]="(module.similarity * 100).toFixed(1) + '%'" [severity]="module.similarity > 0.7 ? 'danger' : module.similarity > 0.4 ? 'warn' : 'success'" />
          </ng-template>
        }
      </p-panel>
    }
  </div>
}
